from Crypto.Util.number import getPrime
from math import prod
from sympy import sieve
from secret import FLAG

FLAGLEN = 18
assert len(FLAG) == FLAGLEN

p = getPrime(2048)
q = getPrime(2048)
n = p*q
e = 3
m = prod(pow(sieve[i], FLAG[FLAGLEN - i], n) for i in range(1, FLAGLEN + 1))
c = pow(m, e, n)
print(f"{n = }")
print(f"{c = }")

'''
n = 321349515590314206653975895432643161024198725364502097901215631564603177206154585461760766717276571316410658476289686508260532316793692608064919458948083382483101363059340017926999976568726918773459131692587387645281862701208824882320014814931713846065119696197851641589909024505716513113684648942511811428855541968716867558451395896997093547900543442307479204613943302833055258844470233285415576488376761043630775980792189968000117568621064255260454007993833440149881403737777700074253930163208368182458955127418840485108826775653094305883722679843120609842746545647980276739724453603945098639614587639553894325226064899255912615981939503289649680081061052014214551979109903716116146292105338418383864633246803381013023378185975437824201699259798724795235804527283395691872942543679896169808627298527835697909154189776058293601591652396377584328583130758231889962282254304091789715423552329159359744325620205165341922607813077159373695452179964089108558761156399290075972750245356513875690126014073854317461194248468631565219024533943376250425407183859075767307951412279124314025745800720287511382116534828215106045147829552357220181636869639381059497048529914148702349836113432637407651863422101592478222813758235959596281245096483
c = 261332720226137976530358137785198757089872077737947235494671199683831734450377618120600168743129902865816781161737250942399209702868032520039386249284115238379957133988920240278374695026010437799004653973649293981482252431562143407898652136999340238310717625974743822713232317800335432520580555526676805286700535627757399997430405788883996020667073820252059182768725911866782381816848001049060535665064751177817408100441812852918875511209023710995109768837716326305419984337322503671080842740160876423415829592862873099921788833917251903476825609929001437916213638677452781919466813239817675974854567941673868911691127662754877798002255347442804325092243875749279565769999138563526241734460845462521826321198454323372573536316286485174979152292216850678048992185667162096877672604667753412484304644675431763394997842271158988656189952785029745583181118742362444028707439510059483610703340503414661524126354027729569079905113675851615524351823520431108471456057629195611373530645397692617691297136809228350139475937326983575940694342685307945926705459989465914550726653667632456933670733441103838163008982437138560648251218309526780355286399621347793620941872995356229988532477423672671240951284188906821465163789297363338348704973444
'''
