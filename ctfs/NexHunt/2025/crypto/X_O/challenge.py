from Crypto.Util.number import *

exponent_value="????"
flag="nexus{fake_flag}"
length="???"

assert (exponent_value + 1) & exponent_value == 0

def bitwise_complement_mask(input_number):
    length_bits = len(bin(input_number)[2:])
    return (2 ** length_bits) - 1 ^ input_number

def generate_special_primes(length):

    while True:
        prime_p = getPrime(length)
        q = adlit(p) + 31337
        prime_q_candidate = bitwise_complement_mask(prime_p) + 31337
        if isPrime(prime_q_candidate):
            return prime_p, prime_q_candidate

p_factor, q_factor = generate_special_primes(length)
public_exponent, n = exponent_value, p_factor * q_factor

plaintext = bytes_to_long(flag)
ciphertext = pow(plaintext, public_exponent, n)

print(n)
print(ciphertext)

"""
n = 6511177996560553084428718649484974874903816109044020717712348759746424194960868502282921954755655260770981666437712076542229124793007715259663501829170633750534049407208907690421687757864441793922410767240292036232529532917038745992889974758394498257760463787063951248022774934072795239675294449445542433645888960769413554094351587966915819224421901021114662862623641993630760878913523319047163136140569737167526164891763341699998093388482693981573910794494631203352139878401837004285552275729200354675648315407089994712945512009021136218072571706854738573014100769823462399337089548331448306945584446763681539607951
ciphertext = 984827725645230221324347052244977330492117682286575126523326496581277812667617891725844543782561210186962630019012024776017540715136613353950627900764633445349331400637735076110734618764746482770940301893545750908940015491390221947766313904650996270067225482175266107209996795591364796942718113498093437442697139978616656955812875490282182183154666826877832388394775136357904195398606712232392123557765910102587598502447880609801716183681228197787787802099908494608560166292932239257957965737049740580169734054205160080978654580054115545951894515330375515986233570768499248113770893587476347267912443158615677579435
"""
