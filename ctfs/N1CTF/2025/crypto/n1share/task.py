from Crypto.Cipher import AES
import random, os, hashlib
FLAG = b"n1ctf{REDACTED}"

p = 521
drunk = random.sample(range(1, p), 300)
key = os.urandom(256)

shares = []
for x in range(1, p):
    y = [sum(c*pow(x,i,p) for i,c in enumerate(key[:128])),
            sum(c*pow(x,i,p) for i,c in enumerate(key[128:]))]
    shares.extend([(y[j]+(x in drunk)*random.randint(0,p-1))%p for j in range(2)])

print(f'share: {shares}')
print(f'ct: {AES.new(hashlib.md5(key).digest(), AES.MODE_ECB).encrypt(FLAG).hex()}')
"""
share: [209, 394, 389, 194, 513, 419, 261, 336, 291, 164, 440, 405, 451, 100, 289, 332, 397, 439, 204, 411, 295, 476, 474, 491, 424, 69, 222, 186, 137, 344, 57, 186, 355, 18, 426, 435, 461, 222, 133, 110, 452, 431, 195, 254, 245, 306, 440, 372, 335, 515, 453, 490, 242, 399, 1, 294, 145, 238, 99, 80, 271, 445, 2, 482, 398, 43, 135, 392, 337, 432, 153, 518, 235, 159, 366, 483, 244, 349, 475, 270, 3, 239, 185, 481, 326, 202, 128, 512, 111, 357, 273, 116, 391, 115, 221, 376, 448, 443, 398, 21, 253, 373, 504, 233, 255, 317, 132, 187, 336, 139, 148, 513, 167, 329, 220, 62, 492, 250, 403, 56, 390, 489, 90, 185, 100, 462, 241, 308, 416, 515, 256, 265, 242, 423, 317, 57, 425, 171, 359, 414, 14, 207, 18, 6, 316, 126, 469, 150, 477, 73, 130, 374, 37, 232, 185, 387, 356, 418, 67, 267, 287, 370, 334, 302, 238, 91, 515, 403, 459, 394, 472, 288, 280, 168, 403, 390, 72, 149, 491, 142, 144, 66, 505, 62, 447, 270, 47, 213, 380, 384, 423, 433, 466, 483, 438, 390, 44, 451, 168, 470, 168, 79, 459, 452, 517, 53, 515, 141, 428, 414, 146, 418, 261, 136, 325, 514, 196, 345, 98, 474, 468, 268, 315, 163, 324, 262, 147, 204, 100, 169, 495, 414, 156, 377, 482, 45, 105, 239, 347, 107, 235, 482, 299, 60, 355, 455, 276, 266, 365, 14, 381, 337, 334, 402, 386, 344, 469, 375, 294, 17, 170, 40, 155, 216, 424, 2, 431, 29, 165, 179, 374, 135, 347, 346, 437, 466, 6, 497, 440, 309, 200, 226, 24, 416, 188, 67, 242, 227, 387, 374, 478, 185, 80, 367, 145, 263, 156, 52, 234, 196, 465, 434, 325, 154, 436, 310, 41, 13, 223, 166, 282, 142, 383, 393, 502, 334, 21, 83, 128, 35, 68, 184, 110, 163, 362, 353, 513, 382, 57, 474, 47, 492, 442, 415, 403, 282, 171, 94, 374, 470, 56, 476, 296, 321, 293, 416, 185, 249, 214, 177, 152, 383, 225, 397, 496, 273, 174, 112, 132, 120, 329, 445, 171, 317, 420, 498, 151, 458, 187, 103, 478, 40, 249, 432, 370, 407, 317, 306, 328, 90, 416, 501, 131, 489, 416, 396, 256, 396, 226, 30, 448, 366, 317, 35, 288, 264, 14, 297, 94, 116, 338, 435, 505, 106, 465, 131, 378, 144, 461, 272, 297, 506, 130, 139, 463, 472, 29, 355, 186, 418, 65, 80, 520, 305, 19, 251, 147, 165, 165, 467, 148, 450, 227, 472, 113, 55, 35, 384, 373, 13, 332, 328, 499, 425, 276, 374, 38, 338, 177, 234, 450, 328, 443, 203, 133, 195, 15, 56, 369, 384, 420, 181, 489, 329, 501, 305, 122, 209, 83, 323, 171, 315, 83, 310, 56, 480, 29, 129, 180, 82, 405, 300, 495, 517, 154, 117, 437, 509, 454, 410, 220, 150, 428, 30, 374, 424, 20, 42, 340, 159, 93, 104, 489, 422, 104, 403, 118, 30, 427, 504, 183, 74, 148, 432, 148, 351, 504, 6, 453, 103, 59, 137, 366, 9, 232, 255, 500, 300, 73, 5, 442, 364, 169, 9, 346, 241, 23, 13, 278, 388, 247, 422, 50, 139, 486, 397, 186, 502, 204, 223, 482, 323, 210, 70, 55, 156, 77, 389, 235, 116, 504, 370, 150, 490, 201, 459, 272, 447, 433, 119, 351, 10, 99, 73, 292, 442, 98, 140, 301, 413, 476, 428, 95, 288, 75, 44, 127, 408, 99, 78, 54, 247, 9, 148, 472, 176, 468, 112, 479, 117, 14, 428, 375, 321, 473, 460, 86, 436, 164, 114, 342, 216, 307, 117, 221, 28, 381, 404, 95, 372, 310, 286, 124, 405, 479, 290, 272, 493, 147, 294, 97, 355, 409, 161, 309, 412, 7, 209, 373, 464, 216, 248, 131, 62, 38, 467, 431, 399, 492, 243, 483, 196, 34, 32, 53, 119, 433, 357, 221, 32, 456, 55, 18, 438, 486, 101, 362, 46, 135, 13, 360, 49, 144, 372, 479, 496, 95, 266, 136, 349, 191, 376, 143, 389, 117, 81, 433, 386, 101, 404, 323, 88, 104, 249, 477, 370, 430, 402, 219, 102, 254, 393, 403, 482, 245, 16, 436, 109, 175, 405, 341, 281, 353, 20, 389, 371, 60, 62, 320, 234, 505, 367, 451, 8, 413, 108, 409, 323, 220, 294, 98, 439, 464, 77, 351, 86, 415, 92, 368, 29, 426, 318, 243, 405, 186, 241, 245, 129, 145, 146, 441, 514, 57, 146, 2, 182, 37, 75, 2, 206, 366, 282, 107, 486, 286, 285, 326, 448, 22, 358, 506, 280, 265, 399, 267, 139, 458, 75, 254, 206, 449, 43, 99, 327, 12, 209, 106, 293, 349, 143, 295, 100, 519, 127, 251, 55, 143, 472, 464, 378, 362, 390, 63, 54, 227, 225, 354, 321, 442, 339, 390, 139, 347, 481, 390, 341, 511, 394, 394, 150, 119, 108, 125, 59, 223, 337, 188, 174, 278, 126, 375, 472, 357, 225, 510, 496, 382, 503, 234, 117, 264, 322, 44, 253, 153, 505, 364, 476, 336, 347, 90, 448, 387, 183, 482, 45, 177, 416, 136, 67, 336, 223, 504, 0, 379, 41, 504, 453, 365, 152, 216, 446, 502, 199, 277, 67, 176, 43, 303, 353, 212, 469, 301, 210, 96, 156, 404, 282, 446, 271, 214, 400, 457, 120, 364, 406, 79, 108, 194, 6, 375, 18, 437, 52, 361, 501, 3, 220, 150, 498, 241, 127, 414, 452, 121, 304, 118, 257, 33, 214, 177, 54, 177, 129, 519, 455, 395, 211, 122, 258, 209, 197, 321, 177, 57, 82, 241, 517, 429, 315, 106, 304, 446, 355, 113, 285, 95, 355, 508, 104, 265, 297, 73, 206, 180, 256, 363, 316, 15, 370, 461, 322, 112, 77, 395, 307, 484, 255, 490, 269, 130, 188, 462, 62, 356, 171, 180, 127, 41, 203, 264, 497, 432, 19, 445, 247, 279, 195, 480, 515, 273, 472, 481, 419, 65, 511, 81, 372, 137, 114, 181, 356, 496, 431, 115, 99, 192, 455, 274, 358, 103, 102, 18, 201, 430, 133, 43, 201, 109, 474, 491, 52, 492, 441, 446, 449, 236, 122, 200, 132, 403, 113, 75, 262, 312, 510, 421, 183, 173, 308]
ct: 251fda75781d082844233d7b5391d1cf97de6dc57e0035ce02db0960ec664552
"""